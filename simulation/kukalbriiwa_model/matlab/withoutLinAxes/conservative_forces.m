function tmpreturn = conservative_forces(q, q_p, theta, param)
  m = [0 0 0 0 0 0 0 0 0 0 0 0 0 0;];
  t1 = param.m7 * param.sp7x;
  t2 = q(7);
  t3 = sin(t2);
  t4 = t3 * t1;
  t5 = param.m7 * param.sp7y;
  t6 = cos(t2);
  t7 = t6 * t5;
  t10 = -param.m5 * param.sp5y + param.m6 * param.sp6z + t4 + t7;
  t11 = q(5);
  t12 = cos(t11);
  t13 = t12 * t10;
  t14 = t6 * t1;
  t15 = t3 * t5;
  t17 = -param.m6 * param.sp6x + t14 - t15;
  t18 = q(6);
  t19 = cos(t18);
  t20 = t19 * t17;
  t21 = param.d7 + param.sp7z;
  t23 = param.m6 * param.sp6y;
  t24 = param.m7 * t21 + t23;
  t25 = sin(t18);
  t26 = t25 * t24;
  t27 = param.m5 * param.sp5x;
  t28 = t20 + t26 - t27;
  t29 = sin(t11);
  t30 = t29 * t28;
  t33 = param.m3 * param.sp3y - param.m4 * param.sp4z + t13 + t30;
  t34 = q(3);
  t35 = cos(t34);
  t36 = t35 * t33;
  t37 = sin(t34);
  t38 = t19 * t24;
  t39 = -t17;
  t40 = t25 * t39;
  t41 = param.d5 + param.d6;
  t44 = param.d5 + param.sp5z;
  t46 = param.m4 * param.sp4y;
  t47 = param.m5 * t44 + param.m6 * t41 + param.m7 * t41 + t38 + t40 + t46;
  t48 = t47 * t37;
  t49 = q(4);
  t50 = sin(t49);
  t52 = t12 * t28;
  t53 = -t10;
  t55 = param.m4 * param.sp4x;
  t56 = t29 * t53 + t52 + t55;
  t57 = t37 * t56;
  t58 = cos(t49);
  t64 = param.m3 * param.sp3x * t37 + param.m1 * param.sp1y + param.m2 * param.sp2z - t48 * t50 + t57 * t58 + t36;
  t65 = q(1);
  t66 = sin(t65);
  t68 = t47 * t50;
  t69 = t19 * t39;
  t72 = -param.m7 * t21 - t23;
  t73 = t25 * t72;
  t74 = t69 + t73 + t27;
  t76 = t29 * t10;
  t77 = t12 * t74 - t55 + t76;
  t78 = t58 * t77;
  t80 = -param.m3 * param.sp3x + t68 + t78;
  t82 = t37 * t33;
  t84 = param.m2 * param.sp2x + t35 * t80 + t82;
  t85 = q(2);
  t86 = cos(t85);
  t87 = t86 * t84;
  t88 = t50 * t77;
  t89 = t19 * t72;
  t90 = t25 * t17;
  t91 = -t41;
  t96 = -param.m5 * t44 + param.m6 * t91 + param.m7 * t91 - t46 + t89 + t90;
  t98 = -param.d3 - param.d4;
  t103 = -param.sp3z - param.d3;
  t105 = param.m2 * param.sp2y;
  t106 = param.m3 * t103 + param.m4 * t98 + param.m5 * t98 + param.m6 * t98 + param.m7 * t98 + t58 * t96 - t105 + t88;
  t107 = sin(t85);
  t110 = -param.m1 * param.sp1x + t106 * t107 + t87;
  t111 = cos(t65);
  t114 = sin(param.roll);
  t116 = cos(param.pitch);
  t121 = sin(param.pitch);
  t129 = (theta(1) - t65) * param.K__1;
  m(1,1) = param.g * (t116 * t114 * (-t110 * t111 - t64 * t66) + t121 * (-t110 * t66 + t111 * t64)) + param.beta * q_p(1) - t129;
  t132 = t106 * t86 - t107 * t84;
  t136 = t58 * t47;
  t137 = -t98;
  t147 = cos(param.roll);
  t159 = (theta(2) - t85) * param.K__2;
  m(1,2) = param.g * (t116 * (-t114 * t66 * t132 + t147 * (-t107 * (-param.m3 * t103 + param.m4 * t137 + param.m5 * t137 + param.m6 * t137 + param.m7 * t137 + t50 * t56 + t105 + t136) + t87)) + t121 * t111 * t132) + param.beta * q_p(2) - t159;
  t166 = param.m3 * param.sp3x * t35 - t35 * t47 * t50 + t35 * t56 * t58 - t82;
  t169 = -t37 * t80 + t36;
  t170 = t86 * t169;
  t188 = (theta(3) - t34) * param.K__3;
  m(1,3) = param.g * (t116 * (t114 * (t111 * t166 - t170 * t66) + t147 * t107 * t169) + t121 * (t111 * t170 + t166 * t66)) + param.beta * q_p(3) - t188;
  t191 = -t48 * t58 - t50 * t57;
  t194 = t35 * (t136 - t88);
  t199 = t86 * t194 + t107 * (-t50 * t96 + t78);
  t221 = (theta(4) - t49) * param.K__4;
  m(1,4) = param.g * (t116 * (t114 * (t111 * t191 - t199 * t66) + t147 * (t86 * (t56 * t58 - t68) + t107 * t194)) + t121 * (t111 * t199 + t191 * t66)) + param.beta * q_p(4) - t221;
  t222 = -t76 + t52;
  t225 = t12 * t53 - t30;
  t228 = t225 * t37 * t58 + t222 * t35;
  t231 = -t29 * t74 + t13;
  t235 = t231 * t35 * t58 + t222 * t37;
  t239 = t107 * t231 * t50 + t235 * t86;
  t260 = (theta(5) - t11) * param.K__5;
  m(1,5) = param.g * (t116 * (t114 * (t111 * t228 - t239 * t66) + t147 * (t225 * t50 * t86 + t107 * t235)) + t121 * (t111 * t239 + t228 * t66)) + param.beta * q_p(5) - t260;
  t261 = -t90 + t38;
  t262 = t29 * t261;
  t264 = -t26 + t69;
  t267 = t12 * t261;
  t270 = -t264 * t37 * t50 + t267 * t37 * t58 + t262 * t35;
  t274 = t12 * (-t40 + t89);
  t279 = t35 * (t264 * t50 + t274 * t58) + t37 * t262;
  t286 = t86 * t279 + t107 * (t50 * t274 + t58 * (-t73 + t20));
  t309 = (theta(6) - t18) * param.K__6;
  m(1,6) = param.g * (t116 * (t114 * (t111 * t270 - t286 * t66) + t147 * (t86 * (t264 * t58 + t267 * t50) + t107 * t279)) + t121 * (t111 * t286 + t270 * t66)) + param.beta * q_p(6) - t309;
  t310 = t14 - t15;
  t312 = -t4 - t7;
  t313 = t19 * t312;
  t315 = t12 * t310 + t29 * t313;
  t317 = -t312;
  t324 = t12 * t313 - t29 * t310;
  t327 = -t25 * t317 * t37 * t50 + t324 * t37 * t58 + t315 * t35;
  t329 = t25 * t317;
  t334 = t12 * t19 * t317 + t29 * t310;
  t339 = t35 * (t329 * t50 + t334 * t58) + t37 * t315;
  t346 = t86 * t339 + t107 * (t25 * t312 * t58 + t334 * t50);
  t369 = (theta(7) - t2) * param.K__7;
  m(1,7) = param.g * (t116 * (t114 * (t111 * t327 - t346 * t66) + t147 * (t86 * (t324 * t50 + t329 * t58) + t107 * t339)) + t121 * (t111 * t346 + t327 * t66)) + param.beta * q_p(7) - t369;
  m(1,8) = t129;
  m(1,9) = t159;
  m(1,10) = t188;
  m(1,11) = t221;
  m(1,12) = t260;
  m(1,13) = t309;
  m(1,14) = t369;
  tmpreturn = m';
