function tmpreturn = gravitational_forces(q, param)
  m = [0 0 0 0 0 0 0;];
  t1 = param.m7 * param.sp7x;
  t2 = q(7);
  t3 = sin(t2);
  t4 = t3 * t1;
  t5 = param.m7 * param.sp7y;
  t6 = cos(t2);
  t7 = t6 * t5;
  t10 = -param.m5 * param.sp5y + param.m6 * param.sp6z + t4 + t7;
  t11 = q(5);
  t12 = cos(t11);
  t13 = t12 * t10;
  t14 = t6 * t1;
  t15 = t3 * t5;
  t17 = -param.m6 * param.sp6x + t14 - t15;
  t18 = q(6);
  t19 = cos(t18);
  t20 = t19 * t17;
  t21 = param.d7 + param.sp7z;
  t23 = param.m6 * param.sp6y;
  t24 = param.m7 * t21 + t23;
  t25 = sin(t18);
  t26 = t25 * t24;
  t27 = param.m5 * param.sp5x;
  t28 = t20 + t26 - t27;
  t29 = sin(t11);
  t30 = t29 * t28;
  t33 = param.m3 * param.sp3y - param.m4 * param.sp4z + t13 + t30;
  t34 = q(3);
  t35 = cos(t34);
  t36 = t35 * t33;
  t37 = sin(t34);
  t38 = t19 * t24;
  t39 = -t17;
  t40 = t25 * t39;
  t41 = param.d5 + param.d6;
  t44 = param.d5 + param.sp5z;
  t46 = param.m4 * param.sp4y;
  t47 = param.m5 * t44 + param.m6 * t41 + param.m7 * t41 + t38 + t40 + t46;
  t48 = t47 * t37;
  t49 = q(4);
  t50 = sin(t49);
  t52 = t12 * t28;
  t53 = -t10;
  t55 = param.m4 * param.sp4x;
  t56 = t29 * t53 + t52 + t55;
  t57 = t37 * t56;
  t58 = cos(t49);
  t64 = param.m3 * param.sp3x * t37 + param.m1 * param.sp1y + param.m2 * param.sp2z - t48 * t50 + t57 * t58 + t36;
  t65 = q(1);
  t66 = sin(t65);
  t68 = t50 * t47;
  t69 = t19 * t39;
  t72 = -param.m7 * t21 - t23;
  t73 = t25 * t72;
  t74 = t69 + t73 + t27;
  t76 = t29 * t10;
  t77 = t12 * t74 - t55 + t76;
  t78 = t58 * t77;
  t80 = -param.m3 * param.sp3x + t68 + t78;
  t82 = t37 * t33;
  t84 = param.m2 * param.sp2x + t35 * t80 + t82;
  t85 = q(2);
  t86 = cos(t85);
  t87 = t86 * t84;
  t88 = t50 * t77;
  t89 = t19 * t72;
  t90 = t25 * t17;
  t91 = -t41;
  t96 = -param.m5 * t44 + param.m6 * t91 + param.m7 * t91 - t46 + t89 + t90;
  t98 = -param.d3 - param.d4;
  t103 = -param.sp3z - param.d3;
  t105 = param.m2 * param.sp2y;
  t106 = param.m3 * t103 + param.m4 * t98 + param.m5 * t98 + param.m6 * t98 + param.m7 * t98 + t58 * t96 - t105 + t88;
  t107 = sin(t85);
  t110 = -param.m1 * param.sp1x + t106 * t107 + t87;
  t111 = cos(t65);
  t114 = sin(param.roll);
  t116 = cos(param.pitch);
  t121 = sin(param.pitch);
  m(1,1) = param.g * (t116 * t114 * (-t110 * t111 - t64 * t66) + t121 * (-t110 * t66 + t111 * t64));
  t126 = t106 * t86 - t107 * t84;
  t130 = t58 * t47;
  t131 = -t98;
  t141 = cos(param.roll);
  m(1,2) = param.g * (t116 * (-t114 * t66 * t126 + t141 * (-t107 * (-param.m3 * t103 + param.m4 * t131 + param.m5 * t131 + param.m6 * t131 + param.m7 * t131 + t50 * t56 + t105 + t130) + t87)) + t121 * t111 * t126);
  t154 = param.m3 * param.sp3x * t35 - t35 * t47 * t50 + t35 * t56 * t58 - t82;
  t157 = -t37 * t80 + t36;
  t158 = t86 * t157;
  m(1,3) = param.g * (t116 * (t114 * (t111 * t154 - t158 * t66) + t141 * t107 * t157) + t121 * (t111 * t158 + t154 * t66));
  t173 = -t48 * t58 - t50 * t57;
  t176 = t35 * (t130 - t88);
  t181 = t86 * t176 + t107 * (-t50 * t96 + t78);
  m(1,4) = param.g * (t116 * (t114 * (t111 * t173 - t181 * t66) + t141 * (t86 * (t56 * t58 - t68) + t107 * t176)) + t121 * (t111 * t181 + t173 * t66));
  t198 = -t76 + t52;
  t201 = t12 * t53 - t30;
  t204 = t201 * t37 * t58 + t198 * t35;
  t207 = -t29 * t74 + t13;
  t211 = t207 * t35 * t58 + t198 * t37;
  t215 = t107 * t207 * t50 + t211 * t86;
  m(1,5) = param.g * (t116 * (t114 * (t111 * t204 - t215 * t66) + t141 * (t201 * t50 * t86 + t107 * t211)) + t121 * (t111 * t215 + t204 * t66));
  t231 = -t90 + t38;
  t232 = t29 * t231;
  t234 = -t26 + t69;
  t237 = t12 * t231;
  t240 = -t234 * t37 * t50 + t237 * t37 * t58 + t232 * t35;
  t244 = t12 * (-t40 + t89);
  t249 = t35 * (t234 * t50 + t244 * t58) + t37 * t232;
  t256 = t86 * t249 + t107 * (t50 * t244 + t58 * (-t73 + t20));
  m(1,6) = param.g * (t116 * (t114 * (t111 * t240 - t256 * t66) + t141 * (t86 * (t234 * t58 + t237 * t50) + t107 * t249)) + t121 * (t111 * t256 + t240 * t66));
  t274 = t14 - t15;
  t276 = -t4 - t7;
  t277 = t19 * t276;
  t279 = t12 * t274 + t277 * t29;
  t281 = -t276;
  t288 = t12 * t277 - t274 * t29;
  t291 = -t25 * t281 * t37 * t50 + t288 * t37 * t58 + t279 * t35;
  t293 = t25 * t281;
  t298 = t12 * t19 * t281 + t274 * t29;
  t303 = t35 * (t293 * t50 + t298 * t58) + t37 * t279;
  t310 = t86 * t303 + t107 * (t25 * t276 * t58 + t298 * t50);
  m(1,7) = param.g * (t116 * (t114 * (t111 * t291 - t310 * t66) + t141 * (t86 * (t288 * t50 + t293 * t58) + t107 * t303)) + t121 * (t111 * t310 + t291 * t66));
  tmpreturn = m';
